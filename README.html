<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1 id="epos2plot-converts-epos-output-to-plots"><code>Epos2plot</code> Converts <code>epos</code> Output to Plots</h1>
<h2 id="dependencies">Dependencies</h2>
<p><code>Epos2plot</code> is written in Go and requires a working <a href="https://golang.org/">Go environment</a>.</p>
<h2 id="installation">Installation</h2>
<p>Download <code>epos2plot</code> and install it</p>
<pre><code>go get -u  github.com/evolbioinf/epos2plot
go install github.com/evolbioinf/epos2plot</code></pre>
<h2 id="examples">Examples</h2>
<p>The example data is based on Figure 2a of <span class="citation">Liu and Fu (2015)</span>: The population size is 10,000 and 10 sequences of length 10Mbp were simulated with 1000 replications using the coalescent simulator <a href="https://pypi.org/project/msprime/"><code>mspms</code></a> <span class="citation">(Kelleher, Etheridge, and McVean 2016)</span>. Its output was converted to <a href="https://en.wikipedia.org/wiki/Allele_frequency_spectrum">site frequency spectra</a> using <a href="http://github.com/evolbioinf/sfs"><code>sfs</code></a>, and the site frequency spectra in turn were converted to population sizes using <a href="http://github.com/evolbioinf/epos"><code>epos</code></a>:</p>
<pre><code>for i in $(seq 1000); do
    mspms 10 1 -t 12310 -r 9750 10000000 -eN 0.066 0.3 | 
    sfs -f |
    epos -u 1.2e-1
done &gt; fig2a_10.epos</code></pre>
<p>The resulting output is located at</p>
<pre><code>$GOPATH/src/github.com/evolbioinf/epos2plot/data/fig2a_10.epos.bz2</code></pre>
<p>and can be displayed in “raw” format using the program <a href="http://github.com/evolbioinf/pipeplot"><code>pipePlot</code></a>:</p>
<pre><code>bzcat $GOPATH/src/github.com/evolbioinf/epos2plot/data/fig2a_10.epos.bz2 |
epos2plot -r | 
pipePlot</code></pre>
<p>Instead of plotting raw <code>epos</code> results, <code>epos2plot</code> by default computes 2.5% and 97.5% quantiles around the median:</p>
<pre><code>bzcat $GOPATH/src/github.com/evolbioinf/epos2plot/data/fig2a_10.epos.bz2 |
epos2plot | 
head
#Time   LowerQ  Median  UpperQ  SampleSize
0   9550    10200   18700   987
463 9550    10200   18700   987
482 9550    10200   18700   987
487 9550    10200   18700   987
491 9550    10200   18700   987
502 9550    10200   18700   987
505 9550    10200   18700   987
506 9550    10200   18700   987
510 9540    10200   18700   987</code></pre>
<p>where <code>Time</code> contains the time in generations, <code>LowerQ</code> the lower quantile of the population size, <code>Median</code> its median, and <code>UpperQ</code> its upper quantile. Notice how these values are close to the expected 10,000. The column <code>SampleSize</code>, finally, lists the number of data points from which the quantiles were computed. As one last example, plot the median:</p>
<pre><code>bzcat $GOPATH/src/github.com/evolbioinf/epos2plot/data/fig2a_10.epos.bz2 |
epos2plot | 
cut -f 1,3 |
pipePlot</code></pre>
<h2 id="references" class="unnumbered">References</h2>
<div id="refs" class="references">
<div id="ref-kel16:eff">
<p>Kelleher, J., A. Etheridge, and G. McVean. 2016. “Efficient Coalesncent Simulation and Genealogical Analysis for Large Sample Sizes.” <em>PLoS Comput.</em> 12: 1–2.</p>
</div>
<div id="ref-liu15:exp">
<p>Liu, X., and Y.-X. Fu. 2015. “Exploring Population Size Changes Using SNP Frequency Spectra.” <em>Nature Genetics</em> 47: 555–62.</p>
</div>
</div>
</body>
</html>
